<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login – Mission Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=Playfair+Display:ital,wght@0,700;1,400&display=swap" rel="stylesheet">
    <style>
        body { background-color: #050505; color: white; font-family: 'Inter', sans-serif; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .btn-gold {
            background: linear-gradient(to bottom right, #EAB308, #CA8A04);
            color: black; font-weight: bold;
            box-shadow: 0 0 20px rgba(234, 179, 8, 0.4);
            transition: transform 0.2s;
        }
        .btn-gold:hover { transform: scale(1.02); }
        .input-dark {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
        }
        .input-dark:focus { border-color: #EAB308; outline: none; }
    </style>
</head>
<body class="h-screen flex items-center justify-center bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]">

    <div class="w-full max-w-md p-8 rounded-2xl border border-white/10 bg-black/80 backdrop-blur-xl shadow-2xl relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-[#EAB308] to-transparent opacity-50"></div>

        <div class="text-center mb-8">
            <div class="inline-block p-3 rounded-full bg-[#EAB308]/10 mb-4 border border-[#EAB308]/20">
                <svg class="w-8 h-8 text-[#EAB308]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
            </div>
            <h1 class="text-3xl font-serif font-bold text-white tracking-wide">Mission Control</h1>
            <p class="text-gray-500 text-sm mt-2 uppercase tracking-widest">Admin Access Only</p>
        </div>

        <form id="loginForm" class="space-y-6">
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">Email</label>
                <input type="email" id="email" class="w-full p-4 rounded-lg input-dark" placeholder="admin@remembered.app" required>
            </div>
            <div>
                <label class="block text-xs font-bold text-gray-500 uppercase tracking-widest mb-2">Password</label>
                <input type="password" id="password" class="w-full p-4 rounded-lg input-dark" placeholder="••••••••" required>
            </div>
            
            <button type="submit" id="submitBtn" class="w-full py-4 rounded-lg btn-gold uppercase tracking-widest text-sm">
                Initialize Session
            </button>
        </form>

        <div id="errorMsg" class="hidden mt-6 p-4 rounded-lg bg-red-900/20 border border-red-500/30 text-red-400 text-sm text-center"></div>
    </div>

    <script>
        // CONFIG
        const supabaseUrl = 'https://aahsaqygohmykhagbihk.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFhaHNhcXlnb2hteWtoYWdiaWhrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcwODQzMDcsImV4cCI6MjA4MjY2MDMwN30.yRGsxsWC9EGO5rR1cy4_9Clt6FvJ05cqRo9qHlVyE-E';
        const db = supabase.createClient(supabaseUrl, supabaseKey);

        const form = document.getElementById('loginForm');
        const errorMsg = document.getElementById('errorMsg');
        const btn = document.getElementById('submitBtn');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            btn.innerHTML = 'VERIFYING...';
            btn.disabled = true;
            errorMsg.classList.add('hidden');

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            const { data, error } = await db.auth.signInWithPassword({ email, password });

            if (error) {
                btn.innerHTML = 'INITIALIZE SESSION';
                btn.disabled = false;
                errorMsg.innerText = "❌ " + error.message;
                errorMsg.classList.remove('hidden');
            } else {
                // Check if actually admin
                const { data: adminCheck } = await db.from('admin_users').select('*').eq('user_id', data.user.id).single();
                
                if (adminCheck) {
                    window.location.href = 'admin.html';
                } else {
                    btn.innerHTML = 'INITIALIZE SESSION';
                    btn.disabled = false;
                    errorMsg.innerText = "⛔ ACCESS DENIED: Not an admin.";
                    errorMsg.classList.remove('hidden');
                    await db.auth.signOut();
                }
            }
        });
    </script>
</body>
</html>
